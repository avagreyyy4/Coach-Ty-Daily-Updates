<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Games - Coach Ty</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

    :root {
      --bg: #eef4f9;
      --surface: #ffffff;
      --accent: #012169;
      --accent-light: #99CAEA;
      --accent-wash: rgba(153, 202, 234, 0.12);
      --text-primary: #012169;
      --text-secondary: #6b7280;
      --text-muted: #9ca3af;
      --border: #e5e7eb;
      --border-light: #f3f4f6;
      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.04);
      --radius: 10px;
      --hot-bg: #fef2f2;
      --hot-border: #fecaca;
      --cool-bg: #eff6ff;
      --cool-border: #bfdbfe;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: var(--bg);
      min-height: 100vh;
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
    }

    .top-bar {
      width: 100%; height: 3px;
      background: linear-gradient(90deg, var(--accent-light), var(--accent), var(--accent-light));
      position: fixed; top: 0; left: 0; z-index: 100;
    }

    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 5rem 1.5rem 4rem;
    }

    /* ── Header ── */
    .page-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .back-link {
      text-decoration: none;
      color: var(--accent-light);
      font-size: 1.25rem;
      line-height: 1;
    }

    .page-header h1 {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.02em;
    }

    .page-header .week-label {
      font-size: 0.8125rem;
      color: var(--text-muted);
      font-weight: 500;
      margin-left: auto;
    }

    /* ── Day columns ── */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(12px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .day-section {
      margin-bottom: 1.5rem;
      opacity: 0;
      animation: fadeInUp 0.4s ease forwards;
    }

    .day-section:nth-child(1) { animation-delay: 0.05s; }
    .day-section:nth-child(2) { animation-delay: 0.1s; }
    .day-section:nth-child(3) { animation-delay: 0.15s; }
    .day-section:nth-child(4) { animation-delay: 0.2s; }
    .day-section:nth-child(5) { animation-delay: 0.25s; }
    .day-section:nth-child(6) { animation-delay: 0.3s; }
    .day-section:nth-child(7) { animation-delay: 0.35s; }

    .day-label {
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--accent);
      margin-bottom: 0.5rem;
      padding-left: 0.25rem;
    }

    .day-label .date-sub {
      font-weight: 500;
      color: var(--text-muted);
      margin-left: 0.5rem;
      text-transform: none;
      letter-spacing: 0;
    }

    /* ── Game cards ── */
    .game-card {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      border-radius: var(--radius);
      border: 1px solid var(--cool-border);
      background: var(--cool-bg);
      margin-bottom: 0.5rem;
      box-shadow: var(--shadow-sm);
    }

    .game-card.hot {
      background: var(--hot-bg);
      border-color: var(--hot-border);
    }

    .game-time {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-secondary);
      min-width: 70px;
      padding-top: 0.1rem;
    }

    .game-info {
      flex: 1;
      min-width: 0;
    }

    .game-matchup {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.3;
    }

    .game-matchup .vs {
      font-weight: 400;
      color: var(--text-muted);
      margin: 0 0.15rem;
    }

    .game-recruits {
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin-top: 0.25rem;
      line-height: 1.4;
    }

    .game-tags {
      display: flex;
      gap: 0.25rem;
      flex-shrink: 0;
      padding-top: 0.1rem;
    }

    .game-tag {
      font-size: 0.6rem;
      font-weight: 700;
      padding: 0.15rem 0.4rem;
      border-radius: 100px;
      white-space: nowrap;
    }

    .game-tag.navy       { background: #012169; color: #fff; }
    .game-tag.columbia   { background: #99CAEA; color: #012169; }
    .game-tag.anthracite { background: #4a4a4a; color: #fff; }

    .empty-msg {
      text-align: center;
      padding: 3rem 1rem;
      color: var(--text-muted);
      font-size: 0.9375rem;
    }
  </style>
</head>
<body>

  <div class="top-bar"></div>

  <div class="container">
    <div class="page-header">
      <a href="index.html" class="back-link">&larr;</a>
      <h1>Games This Week</h1>
      <span class="week-label" id="week-label"></span>
    </div>

    <div id="calendar"></div>
  </div>

  <script>
    const DAYS = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
    const MONTHS = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

    function parseGameDate(str) {
      // "02/06/26 06:30 PM EST" → strip tz, parse
      const clean = str.replace(/ (EST|EDT|CST|CDT|MST|MDT|PST|PDT)$/, "");
      return new Date(clean);
    }

    function formatTime(d) {
      let h = d.getHours();
      const m = d.getMinutes().toString().padStart(2, "0");
      const ampm = h >= 12 ? "PM" : "AM";
      h = h % 12 || 12;
      return `${h}:${m} ${ampm}`;
    }

    function dateKey(d) {
      return `${d.getFullYear()}-${d.getMonth()}-${d.getDate()}`;
    }

    fetch("data/games.json")
      .then(res => res.json())
      .then(games => {
        const cal = document.getElementById("calendar");
        const label = document.getElementById("week-label");

        const now = new Date();
        const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
        const weekOut = new Date(today.getTime() + 7 * 86400000);

        label.textContent = `${MONTHS[today.getMonth()]} ${today.getDate()} \u2013 ${MONTHS[weekOut.getMonth()]} ${weekOut.getDate()}`;

        // Filter to this week and sort by date
        const upcoming = games
          .map(g => ({ ...g, _date: parseGameDate(g.date) }))
          .filter(g => g._date >= today && g._date < weekOut)
          .sort((a, b) => a._date - b._date);

        if (!upcoming.length) {
          cal.innerHTML = '<p class="empty-msg">No games scheduled this week.</p>';
          return;
        }

        // Group by day
        const byDay = new Map();
        upcoming.forEach(g => {
          const k = dateKey(g._date);
          if (!byDay.has(k)) byDay.set(k, { date: g._date, games: [] });
          byDay.get(k).games.push(g);
        });

        let html = "";
        for (const [, day] of byDay) {
          const d = day.date;
          const dayName = DAYS[d.getDay()];
          const dateSub = `${MONTHS[d.getMonth()]} ${d.getDate()}`;

          html += `<div class="day-section">`;
          html += `<div class="day-label">${dayName}<span class="date-sub">${dateSub}</span></div>`;

          day.games.forEach(g => {
            const hot = g.total_tracked > 3;
            const time = formatTime(g._date);
            const cc = g.color_counts || {};
            let tagsHTML = "";
            if (cc["Navy"])          tagsHTML += `<span class="game-tag navy">${cc["Navy"]}N</span>`;
            if (cc["Columbia Blue"]) tagsHTML += `<span class="game-tag columbia">${cc["Columbia Blue"]}CB</span>`;
            if (cc["Anthracite"])    tagsHTML += `<span class="game-tag anthracite">${cc["Anthracite"]}A</span>`;

            const recruits = (g.recruits_2027 || []).join(", ");
            const recruitsHTML = recruits
              ? `<div class="game-recruits">${recruits}</div>`
              : "";

            html += `
              <div class="game-card${hot ? ' hot' : ''}">
                <div class="game-time">${time}</div>
                <div class="game-info">
                  <div class="game-matchup">${g.school_1} <span class="vs">vs</span> ${g.school_2}</div>
                  ${recruitsHTML}
                </div>
                <div class="game-tags">${tagsHTML}</div>
              </div>`;
          });

          html += `</div>`;
        }
        cal.innerHTML = html;
      })
      .catch(() => {
        document.getElementById("calendar").innerHTML =
          '<p class="empty-msg">Could not load games.</p>';
      });
  </script>

</body>
</html>
